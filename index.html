<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مصمم السيرة الذاتية المتقدم</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- خطوط عربية -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Changa:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- خطوط إنجليزية -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --text-color: #333;
            --light-bg: #f5f5f5;
            --white: #ffffff;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
            font-family: 'Inter', 'Tajawal', sans-serif;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        /* شريط الأدوات */
        .toolbar {
            width: 320px;
            background-color: var(--secondary-color);
            color: var(--white);
            padding: 20px;
            overflow-y: auto;
            transition: all 0.3s ease;
        }
        
        .toolbar.collapsed {
            width: 60px;
        }
        
        .toggle-toolbar {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--primary-color);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        .toolbar-section {
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 15px;
        }
        
        .toolbar-section h3 {
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .toolbar-section h3 i {
            font-size: 20px;
        }
        
        .toolbar-section label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .toolbar-section input, 
        .toolbar-section select, 
        .toolbar-section textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: none;
            border-radius: 4px;
            background-color: rgba(255,255,255,0.1);
            color: var(--white);
        }
        
        .color-picker {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.2s;
        }
        
        .color-option:hover {
            transform: scale(1.1);
        }
        
        .color-option.active {
            border-color: var(--white);
            transform: scale(1.1);
        }
        
        .btn {
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
            margin-top: 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            justify-content: center;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-warning {
            background-color: var(--warning-color);
        }
        
        .btn-danger {
            background-color: var(--danger-color);
        }
        
        .btn-info {
            background-color: #17a2b8;
        }
        
        /* منطقة المعاينة */
        .preview-area {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            overflow-y: auto;
            position: relative;
        }
        
        .preview-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .preview-controls .btn {
            width: auto;
            padding: 8px 15px;
        }
        
        .cv-container {
            width: 210mm;
            min-height: 297mm;
            background-color: var(--white);
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            padding: 20mm;
            position: relative;
        }

        /* التصميمات المختلفة للسيرة الذاتية */
        
        /* التصميم 1: كلاسيكي */
        .design-1 .cv-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 20px;
        }
        
        .design-1 .profile-image-container {
            position: relative;
            margin-left: 20px;
        }
        
        .design-1 .profile-image {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
        }
        
        .design-1 .header-info {
            flex: 1;
        }
        
        /* التصميم 2: الصورة في الأعلى */
        .design-2 .cv-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 20px;
        }
        
        .design-2 .profile-image-container {
            position: relative;
            display: inline-block;
            margin-bottom: 15px;
        }
        
        .design-2 .profile-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-color);
        }
        
        /* التصميم 3: جانبي */
        .design-3 {
            display: flex;
        }
        
        .design-3 .cv-sidebar {
            width: 30%;
            background-color: var(--secondary-color);
            color: white;
            padding: 20px;
        }
        
        .design-3 .cv-content {
            width: 70%;
            padding: 20px;
        }
        
        .design-3 .profile-image {
            width: 100%;
            max-width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-color);
            margin: 0 auto 20px;
            display: block;
        }
        
        .design-3 .section-title {
            color: white;
            border-bottom: 1px solid rgba(255,255,255,0.3);
        }
        
        /* التصميم 4: عصري */
        .design-4 .cv-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            margin: -20mm -20mm 30px -20mm;
            text-align: center;
        }
        
        .design-4 .profile-image {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid white;
            margin-bottom: 15px;
        }
        
        .design-4 .section-title {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 8px;
        }
        
        .image-edit-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
            cursor: pointer;
        }
        
        .profile-image-container:hover .image-edit-overlay {
            opacity: 1;
        }
        
        .cv-section {
            margin-bottom: 25px;
            position: relative;
        }
        
        .section-title {
            font-size: 18px;
            color: var(--primary-color);
            margin-bottom: 10px;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-controls {
            display: flex;
            gap: 5px;
        }
        
        .section-controls button {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 14px;
        }
        
        .editable {
            padding: 5px;
            border: 1px dashed transparent;
            border-radius: 4px;
            transition: all 0.2s;
            min-height: 20px;
        }
        
        .editable:hover {
            border-color: #ddd;
            background-color: #f9f9f9;
        }
        
        .editable:focus {
            outline: none;
            border-color: var(--primary-color);
            background-color: #fff;
        }
        
        .design-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .design-option {
            height: 80px;
            border: 2px solid transparent;
            cursor: pointer;
            overflow: hidden;
            border-radius: 5px;
            transition: transform 0.2s;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            padding: 5px;
        }
        
        .design-option:hover {
            transform: scale(1.05);
        }
        
        .design-option.active {
            border-color: var(--primary-color);
        }
        
        .design-preview {
            flex: 1;
            display: flex;
        }
        
        .design-header {
            height: 10px;
            background-color: var(--primary-color);
            margin-bottom: 3px;
        }
        
        .design-sidebar {
            width: 30%;
            background-color: var(--secondary-color);
            margin-left: 3px;
        }
        
        .design-content {
            flex: 1;
            background-color: var(--white);
        }
        
        .design-name {
            text-align: center;
            font-size: 10px;
            margin-top: 3px;
        }
        
        /* تصميم متجاوب */
        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
            }
            
            .toolbar {
                width: 100%;
                max-height: 400px;
            }
            
            .toolbar.collapsed {
                width: 100%;
                max-height: 60px;
                overflow: hidden;
            }
            
            .cv-container {
                width: 100%;
                min-height: auto;
            }
            
            .design-3 {
                flex-direction: column;
            }
            
            .design-3 .cv-sidebar,
            .design-3 .cv-content {
                width: 100%;
            }
        }
        
        @media print {
            .toolbar, .preview-controls {
                display: none;
            }
            
            .cv-container {
                box-shadow: none;
                width: 100%;
                min-height: auto;
            }
        }
        
        .skill-item, .experience-item, .education-item {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 5px;
            background: #f9f9f9;
            position: relative;
        }
        
        .item-controls {
            position: absolute;
            top: 5px;
            left: 5px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .skill-item:hover .item-controls,
        .experience-item:hover .item-controls,
        .education-item:hover .item-controls {
            opacity: 1;
        }
        
        .item-controls button {
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
        }
        
        .skill-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .skill-progress {
            height: 100%;
            background: var(--primary-color);
            border-radius: 4px;
            transition: width 0.5s;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #777;
        }
        
        .text-format-toolbar {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .text-format-toolbar button {
            padding: 5px 10px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .text-format-toolbar button.active {
            background: var(--primary-color);
            color: white;
        }
        
        .quality-options {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .quality-option {
            flex: 1;
            padding: 10px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .quality-option.active {
            border-color: var(--primary-color);
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .share-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        .share-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .share-option:hover {
            background-color: #f5f5f5;
        }
        
        .share-option i {
            font-size: 20px;
            width: 30px;
            text-align: center;
        }
        
        .facebook { color: #3b5998; }
        .twitter { color: #1da1f2; }
        .linkedin { color: #0077b5; }
        .whatsapp { color: #25d366; }
        .link { color: #3498db; }
        
        .image-quality-info {
            background: rgba(255,255,255,0.1);
            padding: 8px;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 12px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--success-color);
            color: white;
            border-radius: 5px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(150%);
            transition: transform 0.3s;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .font-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        
        .font-option {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        
        .font-option:hover {
            border-color: var(--primary-color);
        }
        
        .font-option.active {
            border-color: var(--primary-color);
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .font-option.arabic {
            font-family: 'Tajawal', sans-serif;
        }
        
        .font-option.arabic.messiri {
            font-family: 'El Messiri', sans-serif;
        }
        
        .font-option.arabic.changa {
            font-family: 'Changa', sans-serif;
        }
        
        .font-option.english.inter {
            font-family: 'Inter', sans-serif;
        }
        
        .font-option.english.sf-pro {
            font-family: 'SF Pro Display', sans-serif;
        }
        
        .font-preview {
            font-size: 14px;
            margin-top: 5px;
        }
        
        .font-name {
            font-weight: bold;
            font-size: 12px;
        }
        
        .theme-colors {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 10px;
        }
        
        .theme-color {
            height: 40px;
            border-radius: 5px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .theme-color.active {
            border-color: white;
            transform: scale(1.05);
        }
        
        .download-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        .download-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .download-option:hover {
            background-color: #f5f5f5;
        }
        
        .download-option i {
            font-size: 20px;
            width: 30px;
            text-align: center;
        }
        
        .web-url-input {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .web-url-input input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .web-url-input button {
            padding: 8px 15px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .size-presets {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 10px 0;
        }
        
        .size-preset {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: rgba(255,255,255,0.1);
        }
        
        .size-preset:hover {
            border-color: var(--primary-color);
        }
        
        .size-preset.active {
            border-color: var(--primary-color);
            background-color: rgba(52, 152, 219, 0.2);
        }
        
        .size-preset-name {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 3px;
        }
        
        .size-preset-dimensions {
            font-size: 10px;
            color: #ccc;
        }
        
        .custom-size-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        
        .custom-size-inputs input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        /* تنسيقات خاصة للتحميل */
        .download-mode .section-controls,
        .download-mode .item-controls,
        .download-mode .editable:hover,
        .download-mode .editable:focus {
            display: none !important;
        }
        
        .download-mode .editable {
            border-color: transparent !important;
            background-color: transparent !important;
        }
        
        .download-mode .cv-container {
            box-shadow: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- شريط الأدوات -->
        <div class="toolbar">
            <button class="toggle-toolbar">
                <i class="fas fa-chevron-left"></i>
            </button>
            
            <div class="toolbar-section">
                <h3><i class="fas fa-palette"></i> التصميمات</h3>
                <div class="design-selector">
                    <div class="design-option active" data-design="1">
                        <div class="design-preview">
                            <div class="design-header"></div>
                            <div class="design-content"></div>
                        </div>
                        <div class="design-name">كلاسيكي</div>
                    </div>
                    <div class="design-option" data-design="2">
                        <div class="design-preview">
                            <div class="design-header"></div>
                            <div class="design-content"></div>
                        </div>
                        <div class="design-name">الصورة بالأعلى</div>
                    </div>
                    <div class="design-option" data-design="3">
                        <div class="design-preview">
                            <div class="design-sidebar"></div>
                            <div class="design-content"></div>
                        </div>
                        <div class="design-name">جانبي</div>
                    </div>
                    <div class="design-option" data-design="4">
                        <div class="design-preview">
                            <div class="design-header"></div>
                            <div class="design-content"></div>
                        </div>
                        <div class="design-name">عصري</div>
                    </div>
                </div>
                
                <h3 style="margin-top: 15px;"><i class="fas fa-fill-drip"></i> ألوان التصميم</h3>
                <div class="theme-colors">
                    <div class="theme-color active" style="background: linear-gradient(135deg, #3498db, #2c3e50);" data-primary="#3498db" data-secondary="#2c3e50"></div>
                    <div class="theme-color" style="background: linear-gradient(135deg, #e74c3c, #c0392b);" data-primary="#e74c3c" data-secondary="#c0392b"></div>
                    <div class="theme-color" style="background: linear-gradient(135deg, #2ecc71, #27ae60);" data-primary="#2ecc71" data-secondary="#27ae60"></div>
                    <div class="theme-color" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);" data-primary="#9b59b6" data-secondary="#8e44ad"></div>
                    <div class="theme-color" style="background: linear-gradient(135deg, #f39c12, #d35400);" data-primary="#f39c12" data-secondary="#d35400"></div>
                    <div class="theme-color" style="background: linear-gradient(135deg, #1abc9c, #16a085);" data-primary="#1abc9c" data-secondary="#16a085"></div>
                </div>
            </div>
            
            <div class="toolbar-section">
                <h3><i class="fas fa-image"></i> الصورة الشخصية</h3>
                <button class="btn" id="upload-image-btn">
                    <i class="fas fa-upload"></i> تحميل صورة
                </button>
                <input type="file" id="image-upload" accept="image/*" style="display: none;">
                
                <div class="web-url-input">
                    <input type="text" id="image-url" placeholder="رابط الصورة من الويب">
                    <button id="load-web-image"><i class="fas fa-download"></i></button>
                </div>
                
                <h4 style="margin: 15px 0 10px 0;"><i class="fas fa-crop-alt"></i> مقاسات الصورة</h4>
                <div class="size-presets">
                    <div class="size-preset active" data-width="120" data-height="120" data-shape="circle">
                        <div class="size-preset-name">مربع</div>
                        <div class="size-preset-dimensions">120×120</div>
                    </div>
                    <div class="size-preset" data-width="150" data-height="150" data-shape="circle">
                        <div class="size-preset-name">مربع كبير</div>
                        <div class="size-preset-dimensions">150×150</div>
                    </div>
                    <div class="size-preset" data-width="1080" data-height="1920" data-shape="rectangle">
                        <div class="size-preset-name">تيك توك</div>
                        <div class="size-preset-dimensions">1080×1920</div>
                    </div>
                    <div class="size-preset" data-width="1280" data-height="720" data-shape="rectangle">
                        <div class="size-preset-name">يوتيوب</div>
                        <div class="size-preset-dimensions">1280×720</div>
                    </div>
                    <div class="size-preset" data-width="1200" data-height="630" data-shape="rectangle">
                        <div class="size-preset-name">فيسبوك</div>
                        <div class="size-preset-dimensions">1200×630</div>
                    </div>
                    <div class="size-preset" data-width="1080" data-height="1080" data-shape="circle">
                        <div class="size-preset-name">انستغرام</div>
                        <div class="size-preset-dimensions">1080×1080</div>
                    </div>
                </div>
                
                <div class="custom-size-inputs">
                    <input type="number" id="custom-width" placeholder="العرض" value="120">
                    <input type="number" id="custom-height" placeholder="الارتفاع" value="120">
                </div>
                <button class="btn" id="apply-custom-size">
                    <i class="fas fa-check"></i> تطبيق المقاس المخصص
                </button>
                
                <label style="margin-top: 15px;">تغيير لون الإطار:</label>
                <div class="color-picker" id="image-border-colors">
                    <div class="color-option active" style="background-color: #3498db;" data-color="#3498db"></div>
                    <div class="color-option" style="background-color: #e74c3c;" data-color="#e74c3c"></div>
                    <div class="color-option" style="background-color: #2ecc71;" data-color="#2ecc71"></div>
                    <div class="color-option" style="background-color: #f39c12;" data-color="#f39c12"></div>
                    <div class="color-option" style="background-color: #9b59b6;" data-color="#9b59b6"></div>
                </div>
            </div>
            
            <div class="toolbar-section">
                <h3><i class="fas fa-user"></i> المعلومات الشخصية</h3>
                <input type="text" id="full-name" placeholder="الاسم الكامل">
                <input type="text" id="job-title" placeholder="المسمى الوظيفي">
                <textarea id="personal-summary" placeholder="نبذة شخصية" rows="3"></textarea>
            </div>
            
            <div class="toolbar-section">
                <h3><i class="fas fa-font"></i> الخطوط</h3>
                <label>خطوط عربية:</label>
                <div class="font-selector">
                    <div class="font-option arabic active" data-font="Tajawal">
                        <div class="font-name">تاجوال</div>
                        <div class="font-preview">نص تجريبي</div>
                    </div>
                    <div class="font-option arabic messiri" data-font="El Messiri">
                        <div class="font-name">المسيري</div>
                        <div class="font-preview">نص تجريبي</div>
                    </div>
                    <div class="font-option arabic changa" data-font="Changa">
                        <div class="font-name">تشانغا</div>
                        <div class="font-preview">نص تجريبي</div>
                    </div>
                </div>
                
                <label>خطوط إنجليزية:</label>
                <div class="font-selector">
                    <div class="font-option english sf-pro active" data-font="SF Pro Display">
                        <div class="font-name">SF Pro</div>
                        <div class="font-preview">Sample Text</div>
                    </div>
                    <div class="font-option english inter" data-font="Inter">
                        <div class="font-name">إنتر</div>
                        <div class="font-preview">Sample Text</div>
                    </div>
                </div>
                
                <label>لون النص:</label>
                <div class="color-picker" id="text-colors">
                    <div class="color-option active" style="background-color: #333333;" data-color="#333333"></div>
                    <div class="color-option" style="background-color: #2c3e50;" data-color="#2c3e50"></div>
                    <div class="color-option" style="background-color: #7f8c8d;" data-color="#7f8c8d"></div>
                    <div class="color-option" style="background-color: #e74c3c;" data-color="#e74c3c"></div>
                </div>
                
                <label>حجم النص:</label>
                <input type="range" id="text-size" min="12" max="24" value="16">
                <span id="text-size-value">16px</span>
            </div>
            
            <div class="toolbar-section">
                <h3><i class="fas fa-briefcase"></i> الخبرات</h3>
                <input type="text" id="experience-title" placeholder="عنوان الخبرة">
                <input type="text" id="experience-company" placeholder="اسم الشركة">
                <input type="text" id="experience-duration" placeholder="المدة">
                <textarea id="experience-description" placeholder="وصف الخبرة" rows="3"></textarea>
                <button class="btn" id="add-experience">
                    <i class="fas fa-plus"></i> إضافة خبرة
                </button>
            </div>
            
            <div class="toolbar-section">
                <h3><i class="fas fa-star"></i> المهارات</h3>
                <input type="text" id="skill-name" placeholder="اسم المهارة">
                <input type="range" id="skill-level" min="1" max="10" value="5">
                <span id="skill-level-value">5/10</span>
                <button class="btn" id="add-skill">
                    <i class="fas fa-plus"></i> إضافة مهارة
                </button>
            </div>
            
            <div class="toolbar-section">
                <h3><i class="fas fa-graduation-cap"></i> التعليم</h3>
                <input type="text" id="education-degree" placeholder="الدرجة العلمية">
                <input type="text" id="education-institution" placeholder="المؤسسة التعليمية">
                <input type="text" id="education-year" placeholder="سنة التخرج">
                <button class="btn" id="add-education">
                    <i class="fas fa-plus"></i> إضافة تعليم
                </button>
            </div>
            
            <div class="toolbar-section">
                <h3><i class="fas fa-address-card"></i> التواصل</h3>
                <input type="text" id="contact-email" placeholder="البريد الإلكتروني">
                <input type="text" id="contact-phone" placeholder="رقم الهاتف">
                <input type="text" id="contact-address" placeholder="العنوان">
                <input type="text" id="contact-linkedin" placeholder="رابط LinkedIn">
            </div>
            
            <div class="toolbar-section">
                <button class="btn btn-success" id="download-cv">
                    <i class="fas fa-download"></i> تحميل السيرة الذاتية
                </button>
                <button class="btn btn-info" id="share-cv">
                    <i class="fas fa-share-alt"></i> مشاركة السيرة الذاتية
                </button>
                <button class="btn btn-danger" id="reset-cv">
                    <i class="fas fa-redo"></i> إعادة تعيين
                </button>
            </div>
        </div>
        
        <!-- منطقة المعاينة -->
        <div class="preview-area">
            <div class="preview-controls">
                <button class="btn" id="add-section-btn">
                    <i class="fas fa-plus"></i> إضافة قسم جديد
                </button>
                <button class="btn" id="edit-mode-btn">
                    <i class="fas fa-edit"></i> وضع التعديل
                </button>
                <button class="btn btn-info" id="preview-share-btn">
                    <i class="fas fa-share-alt"></i> مشاركة
                </button>
            </div>
            
            <div class="cv-container design-1" id="cv-preview">
                <div class="cv-header">
                    <div class="profile-image-container">
                        <img src="" alt="الصورة الشخصية" class="profile-image" id="profile-image">
                        <div class="image-edit-overlay">
                            <i class="fas fa-camera text-white" style="font-size: 24px;"></i>
                        </div>
                    </div>
                    <div class="header-info">
                        <h1 id="preview-name" class="editable" contenteditable="false">الاسم الكامل</h1>
                        <h2 id="preview-job-title" class="editable" contenteditable="false">المسمى الوظيفي</h2>
                        <p id="preview-summary" class="editable" contenteditable="false">نبذة شخصية تظهر هنا...</p>
                    </div>
                </div>
                
                <div class="cv-content">
                    <div class="cv-section">
                        <h3 class="section-title">
                            <span>المعلومات الشخصية</span>
                            <div class="section-controls">
                                <button class="edit-section-btn" title="تعديل"><i class="fas fa-edit"></i></button>
                                <button class="remove-section-btn" title="حذف"><i class="fas fa-trash"></i></button>
                            </div>
                        </h3>
                        <div id="preview-contact">
                            <p><strong>البريد الإلكتروني:</strong> <span id="preview-email" class="editable" contenteditable="false">example@example.com</span></p>
                            <p><strong>رقم الهاتف:</strong> <span id="preview-phone" class="editable" contenteditable="false">+1234567890</span></p>
                            <p><strong>العنوان:</strong> <span id="preview-address" class="editable" contenteditable="false">العنوان يظهر هنا</span></p>
                            <p><strong>LinkedIn:</strong> <span id="preview-linkedin" class="editable" contenteditable="false">رابط LinkedIn</span></p>
                        </div>
                    </div>
                    
                    <div class="cv-section">
                        <h3 class="section-title">
                            <span>الخبرات</span>
                            <div class="section-controls">
                                <button class="edit-section-btn" title="تعديل"><i class="fas fa-edit"></i></button>
                                <button class="remove-section-btn" title="حذف"><i class="fas fa-trash"></i></button>
                            </div>
                        </h3>
                        <div id="preview-experiences">
                            <!-- سيتم إضافة الخبرات هنا -->
                        </div>
                    </div>
                    
                    <div class="cv-section">
                        <h3 class="section-title">
                            <span>المهارات</span>
                            <div class="section-controls">
                                <button class="edit-section-btn" title="تعديل"><i class="fas fa-edit"></i></button>
                                <button class="remove-section-btn" title="حذف"><i class="fas fa-trash"></i></button>
                            </div>
                        </h3>
                        <div id="preview-skills">
                            <!-- سيتم إضافة المهارات هنا -->
                        </div>
                    </div>
                    
                    <div class="cv-section">
                        <h3 class="section-title">
                            <span>التعليم</span>
                            <div class="section-controls">
                                <button class="edit-section-btn" title="تعديل"><i class="fas fa-edit"></i></button>
                                <button class="remove-section-btn" title="حذف"><i class="fas fa-trash"></i></button>
                            </div>
                        </h3>
                        <div id="preview-education">
                            <!-- سيتم إضافة التعليم هنا -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة إضافة قسم جديد -->
    <div class="modal" id="add-section-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إضافة قسم جديد</h3>
                <button class="close-modal">&times;</button>
            </div>
            <input type="text" id="new-section-title" placeholder="عنوان القسم الجديد">
            <textarea id="new-section-content" placeholder="محتوى القسم الجديد" rows="5"></textarea>
            <button class="btn" id="confirm-add-section">إضافة القسم</button>
        </div>
    </div>

    <!-- نافذة محرر النصوص -->
    <div class="modal" id="text-editor-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>محرر النص</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="text-format-toolbar">
                <button id="bold-btn" title="عريض"><i class="fas fa-bold"></i></button>
                <button id="italic-btn" title="مائل"><i class="fas fa-italic"></i></button>
                <button id="underline-btn" title="تحته خط"><i class="fas fa-underline"></i></button>
            </div>
            <textarea id="text-editor" rows="10"></textarea>
            <button class="btn" id="save-text">حفظ النص</button>
        </div>
    </div>

    <!-- نافذة المشاركة -->
    <div class="modal" id="share-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>مشاركة السيرة الذاتية</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p>اختر طريقة المشاركة:</p>
            <div class="share-options">
                <div class="share-option" data-platform="facebook">
                    <i class="fab fa-facebook facebook"></i>
                    <span>مشاركة على Facebook</span>
                </div>
                <div class="share-option" data-platform="twitter">
                    <i class="fab fa-twitter twitter"></i>
                    <span>مشاركة على Twitter</span>
                </div>
                <div class="share-option" data-platform="linkedin">
                    <i class="fab fa-linkedin linkedin"></i>
                    <span>مشاركة على LinkedIn</span>
                </div>
                <div class="share-option" data-platform="whatsapp">
                    <i class="fab fa-whatsapp whatsapp"></i>
                    <span>مشاركة على WhatsApp</span>
                </div>
                <div class="share-option" data-platform="link">
                    <i class="fas fa-link link"></i>
                    <span>نسخ الرابط</span>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة تحميل السيرة الذاتية -->
    <div class="modal" id="download-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>تحميل السيرة الذاتية</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p>اختر جودة التحميل:</p>
            <div class="download-options">
                <div class="download-option" data-quality="4k">
                    <i class="fas fa-file-image" style="color: #3498db;"></i>
                    <div>
                        <strong>جودة 4K</strong>
                        <small>دقة عالية - حجم ملف كبير</small>
                    </div>
                </div>
                <div class="download-option" data-quality="hd">
                    <i class="fas fa-file-image" style="color: #2ecc71;"></i>
                    <div>
                        <strong>جودة عالية</strong>
                        <small>دقة متوسطة - حجم ملف معقول</small>
                    </div>
                </div>
                <div class="download-option" data-quality="normal">
                    <i class="fas fa-file-image" style="color: #f39c12;"></i>
                    <div>
                        <strong>جودة عادية</strong>
                        <small>دقة منخفضة - حجم ملف صغير</small>
                    </div>
                </div>
            </div>
            <div class="download-options" style="margin-top: 20px;">
                <div class="download-option" data-format="pdf">
                    <i class="fas fa-file-pdf" style="color: #e74c3c;"></i>
                    <div>
                        <strong>ملف PDF</strong>
                        <small>للطباعة والتقديم الرسمي</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- إشعار -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">تمت العملية بنجاح</span>
    </div>

    <script>
        // العناصر الرئيسية
        const cvPreview = document.getElementById('cv-preview');
        const profileImage = document.getElementById('profile-image');
        const toggleToolbarBtn = document.querySelector('.toggle-toolbar');
        const toolbar = document.querySelector('.toolbar');
        const editModeBtn = document.getElementById('edit-mode-btn');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');
        let editMode = false;
        let currentEditingElement = null;
        let currentDesign = '1';
        let currentArabicFont = 'Tajawal';
        let currentEnglishFont = 'SF Pro Display';
        let currentImageShape = 'circle';

        // وظيفة عرض الإشعار
        function showNotification(message, type = 'success') {
            notificationText.textContent = message;
            notification.className = 'notification show';
            if (type === 'error') {
                notification.style.backgroundColor = '#e74c3c';
            } else if (type === 'warning') {
                notification.style.backgroundColor = '#f39c12';
            } else {
                notification.style.backgroundColor = '#2ecc71';
            }
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // تبديل شريط الأدوات
        toggleToolbarBtn.addEventListener('click', function() {
            toolbar.classList.toggle('collapsed');
            const icon = this.querySelector('i');
            if (toolbar.classList.contains('collapsed')) {
                icon.className = 'fas fa-chevron-right';
            } else {
                icon.className = 'fas fa-chevron-left';
            }
        });

        // تغيير ألوان التصميم
        document.querySelectorAll('.theme-color').forEach(color => {
            color.addEventListener('click', function() {
                document.querySelectorAll('.theme-color').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                
                const primaryColor = this.getAttribute('data-primary');
                const secondaryColor = this.getAttribute('data-secondary');
                
                // تحديث ألوان CSS المخصصة
                document.documentElement.style.setProperty('--primary-color', primaryColor);
                document.documentElement.style.setProperty('--secondary-color', secondaryColor);
                
                showNotification('تم تغيير ألوان التصميم بنجاح');
            });
        });

        // تحميل الصورة الشخصية
        document.getElementById('upload-image-btn').addEventListener('click', function() {
            document.getElementById('image-upload').click();
        });

        document.getElementById('image-upload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    profileImage.src = e.target.result;
                    showNotification('تم تحميل الصورة بنجاح');
                };
                reader.readAsDataURL(file);
            }
        });

        // تحميل صورة من الويب
        document.getElementById('load-web-image').addEventListener('click', function() {
            const imageUrl = document.getElementById('image-url').value;
            if (imageUrl) {
                // التحقق من أن الرابط صحيح
                if (imageUrl.match(/\.(jpeg|jpg|gif|png)$/) != null) {
                    profileImage.src = imageUrl;
                    profileImage.onload = function() {
                        showNotification('تم تحميل الصورة من الويب بنجاح');
                    };
                    profileImage.onerror = function() {
                        showNotification('فشل في تحميل الصورة، الرابط غير صحيح', 'error');
                    };
                } else {
                    showNotification('الرجاء إدخال رابط صورة صحيح (jpg, png, gif)', 'warning');
                }
            } else {
                showNotification('الرجاء إدخال رابط الصورة', 'warning');
            }
        });

        // تغيير مقاسات الصورة المحددة مسبقاً
        document.querySelectorAll('.size-preset').forEach(preset => {
            preset.addEventListener('click', function() {
                document.querySelectorAll('.size-preset').forEach(p => p.classList.remove('active'));
                this.classList.add('active');
                
                const width = this.getAttribute('data-width');
                const height = this.getAttribute('data-height');
                const shape = this.getAttribute('data-shape');
                
                applyImageSize(width, height, shape);
                showNotification(`تم تطبيق مقاس ${this.querySelector('.size-preset-name').textContent}`);
            });
        });

        // تطبيق المق
                // تطبيق المقاس المخصص
        document.getElementById('apply-custom-size').addEventListener('click', function() {
            const width = document.getElementById('custom-width').value;
            const height = document.getElementById('custom-height').value;
            
            if (width && height) {
                applyImageSize(width, height, 'custom');
                showNotification('تم تطبيق المقاس المخصص بنجاح');
            } else {
                showNotification('الرجاء إدخال القيم المطلوبة', 'warning');
            }
        });

        // تطبيق حجم الصورة
        function applyImageSize(width, height, shape) {
            profileImage.style.width = width + 'px';
            profileImage.style.height = height + 'px';
            
            if (shape === 'circle') {
                profileImage.style.borderRadius = '50%';
            } else {
                profileImage.style.borderRadius = '8px';
            }
            
            currentImageShape = shape;
        }

        // تحرير الصورة عند النقر عليها
        document.querySelector('.image-edit-overlay').addEventListener('click', function() {
            document.getElementById('image-upload').click();
        });

        // تغيير لون إطار الصورة
        const imageBorderColors = document.querySelectorAll('#image-border-colors .color-option');
        imageBorderColors.forEach(color => {
            color.addEventListener('click', function() {
                imageBorderColors.forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                const colorValue = this.getAttribute('data-color');
                profileImage.style.borderColor = colorValue;
            });
        });

        // تغيير التصميم
        const designOptions = document.querySelectorAll('.design-option');
        designOptions.forEach(design => {
            design.addEventListener('click', function() {
                designOptions.forEach(d => d.classList.remove('active'));
                this.classList.add('active');
                currentDesign = this.getAttribute('data-design');
                
                // إزالة جميع كلاسات التصميم
                cvPreview.classList.remove('design-1', 'design-2', 'design-3', 'design-4');
                // إضافة كلاس التصميم الجديد
                cvPreview.classList.add(`design-${currentDesign}`);
                
                showNotification(`تم تطبيق التصميم ${currentDesign}`);
            });
        });

        // تغيير الخطوط العربية
        document.querySelectorAll('.font-option.arabic').forEach(font => {
            font.addEventListener('click', function() {
                document.querySelectorAll('.font-option.arabic').forEach(f => f.classList.remove('active'));
                this.classList.add('active');
                currentArabicFont = this.getAttribute('data-font');
                applyFonts();
                showNotification(`تم تطبيق خط ${this.querySelector('.font-name').textContent}`);
            });
        });

        // تغيير الخطوط الإنجليزية
        document.querySelectorAll('.font-option.english').forEach(font => {
            font.addEventListener('click', function() {
                document.querySelectorAll('.font-option.english').forEach(f => f.classList.remove('active'));
                this.classList.add('active');
                currentEnglishFont = this.getAttribute('data-font');
                applyFonts();
                showNotification(`تم تطبيق خط ${this.querySelector('.font-name').textContent}`);
            });
        });

        // تطبيق الخطوط المختارة
        function applyFonts() {
            // تطبيق الخط العربي على النصوص العربية
            const arabicElements = document.querySelectorAll('#cv-preview *');
            arabicElements.forEach(el => {
                // التحقق إذا كان النص يحتوي على أحرف عربية
                const text = el.textContent || el.innerText;
                if (/[\u0600-\u06FF]/.test(text)) {
                    el.style.fontFamily = `${currentArabicFont}, sans-serif`;
                } else if (text.trim() !== '') {
                    // إذا كان النص إنجليزي
                    el.style.fontFamily = `${currentEnglishFont}, sans-serif`;
                }
            });
        }

        // تغيير لون النص
        const textColors = document.querySelectorAll('#text-colors .color-option');
        textColors.forEach(color => {
            color.addEventListener('click', function() {
                textColors.forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                const colorValue = this.getAttribute('data-color');
                cvPreview.style.color = colorValue;
            });
        });

        // تغيير حجم النص
        const textSizeSlider = document.getElementById('text-size');
        const textSizeValue = document.getElementById('text-size-value');
        textSizeSlider.addEventListener('input', function() {
            const size = this.value + 'px';
            cvPreview.style.fontSize = size;
            textSizeValue.textContent = size;
        });

        // تحديث المعلومات الشخصية
        document.getElementById('full-name').addEventListener('input', function() {
            document.getElementById('preview-name').textContent = this.value || 'الاسم الكامل';
        });

        document.getElementById('job-title').addEventListener('input', function() {
            document.getElementById('preview-job-title').textContent = this.value || 'المسمى الوظيفي';
        });

        document.getElementById('personal-summary').addEventListener('input', function() {
            document.getElementById('preview-summary').textContent = this.value || 'نبذة شخصية تظهر هنا...';
        });

        // تحديث معلومات التواصل
        document.getElementById('contact-email').addEventListener('input', function() {
            document.getElementById('preview-email').textContent = this.value || 'example@example.com';
        });

        document.getElementById('contact-phone').addEventListener('input', function() {
            document.getElementById('preview-phone').textContent = this.value || '+1234567890';
        });

        document.getElementById('contact-address').addEventListener('input', function() {
            document.getElementById('preview-address').textContent = this.value || 'العنوان يظهر هنا';
        });

        document.getElementById('contact-linkedin').addEventListener('input', function() {
            document.getElementById('preview-linkedin').textContent = this.value || 'رابط LinkedIn';
        });

        // إضافة الخبرات
        document.getElementById('add-experience').addEventListener('click', function() {
            const title = document.getElementById('experience-title').value;
            const company = document.getElementById('experience-company').value;
            const duration = document.getElementById('experience-duration').value;
            const description = document.getElementById('experience-description').value;
            
            if (title && company) {
                const experienceHTML = `
                    <div class="experience-item">
                        <div class="item-controls">
                            <button class="edit-item-btn"><i class="fas fa-edit"></i></button>
                            <button class="remove-item-btn"><i class="fas fa-trash"></i></button>
                        </div>
                        <h4>${title} - ${company}</h4>
                        <p class="duration">${duration}</p>
                        <p>${description}</p>
                    </div>
                `;
                document.getElementById('preview-experiences').innerHTML += experienceHTML;
                
                // مسح الحقول بعد الإضافة
                document.getElementById('experience-title').value = '';
                document.getElementById('experience-company').value = '';
                document.getElementById('experience-duration').value = '';
                document.getElementById('experience-description').value = '';
                
                // إضافة أحداث للحذف والتعديل
                attachItemEvents();
                showNotification('تمت إضافة الخبرة بنجاح');
            } else {
                showNotification('يرجى ملء العنوان واسم الشركة', 'warning');
            }
        });

        // إضافة المهارات
        document.getElementById('add-skill').addEventListener('click', function() {
            const name = document.getElementById('skill-name').value;
            const level = document.getElementById('skill-level').value;
            
            if (name) {
                const skillHTML = `
                    <div class="skill-item">
                        <div class="item-controls">
                            <button class="edit-item-btn"><i class="fas fa-edit"></i></button>
                            <button class="remove-item-btn"><i class="fas fa-trash"></i></button>
                        </div>
                        <p>${name} <span class="skill-level">${level}/10</span></p>
                        <div class="skill-bar">
                            <div class="skill-progress" style="width: ${level * 10}%"></div>
                        </div>
                    </div>
                `;
                document.getElementById('preview-skills').innerHTML += skillHTML;
                
                // مسح الحقول بعد الإضافة
                document.getElementById('skill-name').value = '';
                document.getElementById('skill-level').value = '5';
                document.getElementById('skill-level-value').textContent = '5/10';
                
                // إضافة أحداث للحذف والتعديل
                attachItemEvents();
                showNotification('تمت إضافة المهارة بنجاح');
            } else {
                showNotification('يرجى إدخال اسم المهارة', 'warning');
            }
        });

        // تحديث مستوى المهارة
        document.getElementById('skill-level').addEventListener('input', function() {
            document.getElementById('skill-level-value').textContent = this.value + '/10';
        });

        // إضافة التعليم
        document.getElementById('add-education').addEventListener('click', function() {
            const degree = document.getElementById('education-degree').value;
            const institution = document.getElementById('education-institution').value;
            const year = document.getElementById('education-year').value;
            
            if (degree && institution) {
                const educationHTML = `
                    <div class="education-item">
                        <div class="item-controls">
                            <button class="edit-item-btn"><i class="fas fa-edit"></i></button>
                            <button class="remove-item-btn"><i class="fas fa-trash"></i></button>
                        </div>
                        <h4>${degree}</h4>
                        <p>${institution} - ${year}</p>
                    </div>
                `;
                document.getElementById('preview-education').innerHTML += educationHTML;
                
                // مسح الحقول بعد الإضافة
                document.getElementById('education-degree').value = '';
                document.getElementById('education-institution').value = '';
                document.getElementById('education-year').value = '';
                
                // إضافة أحداث للحذف والتعديل
                attachItemEvents();
                showNotification('تمت إضافة التعليم بنجاح');
            } else {
                showNotification('يرجى ملء الدرجة العلمية والمؤسسة التعليمية', 'warning');
            }
        });

        // وظيفة لإرفاق أحداث العناصر
        function attachItemEvents() {
            // أحداث حذف العناصر
            document.querySelectorAll('.remove-item-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (confirm('هل أنت متأكد من حذف هذا العنصر؟')) {
                        this.closest('.skill-item, .experience-item, .education-item').remove();
                        showNotification('تم حذف العنصر بنجاح');
                    }
                });
            });
            
            // أحداث تعديل العناصر
            document.querySelectorAll('.edit-item-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const item = this.closest('.skill-item, .experience-item, .education-item');
                    openTextEditor(item.innerHTML);
                    currentEditingElement = item;
                });
            });
        }

        // تحميل السيرة الذاتية كصورة (بدون أزرار التعديل)
        function downloadCVAsImage(quality = 'hd') {
            showNotification('جاري تحضير السيرة الذاتية...');
            
            // إضافة كلاس خاص لإخفاء أزرار التعديل
            cvPreview.classList.add('download-mode');
            
            const scale = quality === '4k' ? 4 : quality === 'hd' ? 2 : 1;
            
            html2canvas(cvPreview, {
                scale: scale,
                useCORS: true,
                logging: false,
                width: cvPreview.scrollWidth,
                height: cvPreview.scrollHeight,
                onclone: function(clonedDoc) {
                    const clonedPreview = clonedDoc.getElementById('cv-preview');
                    clonedPreview.style.boxShadow = 'none';
                    clonedPreview.style.transform = 'scale(1)';
                    
                    // إخفاء أزرار التعديل في النسخة المستنسخة
                    clonedPreview.classList.add('download-mode');
                }
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `السيرة_الذاتية_${new Date().getTime()}.png`;
                link.href = canvas.toDataURL('image/png', 1.0);
                link.click();
                
                // إزالة كلاس التحميل بعد الانتهاء
                cvPreview.classList.remove('download-mode');
                
                showNotification('تم تحميل السيرة الذاتية بنجاح!');
            }).catch(err => {
                console.error('Error generating image:', err);
                cvPreview.classList.remove('download-mode');
                showNotification('حدث خطأ أثناء التحميل', 'error');
            });
        }

        // تحميل السيرة الذاتية كPDF
        function downloadCVAsPDF() {
            // إضافة كلاس خاص لإخفاء أزرار التعديل قبل الطباعة
            cvPreview.classList.add('download-mode');
            window.print();
            
            // إزالة كلاس التحميل بعد الطباعة
            setTimeout(() => {
                cvPreview.classList.remove('download-mode');
            }, 1000);
            
            showNotification('جاري تحضير ملف PDF...');
        }

        // نافذة تحميل السيرة الذاتية
        const downloadModal = document.getElementById('download-modal');
        document.getElementById('download-cv').addEventListener('click', function() {
            downloadModal.style.display = 'flex';
        });

        // معالجة خيارات التحميل
        document.querySelectorAll('.download-option').forEach(option => {
            option.addEventListener('click', function() {
                const quality = this.getAttribute('data-quality');
                const format = this.getAttribute('data-format');
                
                if (format === 'pdf') {
                    downloadCVAsPDF();
                } else {
                    downloadCVAsImage(quality);
                }
                
                downloadModal.style.display = 'none';
            });
        });

        // إعادة تعيين السيرة الذاتية
        document.getElementById('reset-cv').addEventListener('click', function() {
            if (confirm('هل أنت متأكد من إعادة تعيين السيرة الذاتية؟ سيتم حذف جميع البيانات.')) {
                location.reload();
            }
        });

        // وضع التعديل
        editModeBtn.addEventListener('click', function() {
            editMode = !editMode;
            const editables = document.querySelectorAll('.editable');
            
            if (editMode) {
                editables.forEach(el => {
                    el.contentEditable = 'true';
                    el.style.borderColor = '#3498db';
                    el.style.backgroundColor = '#f0f8ff';
                });
                this.innerHTML = '<i class="fas fa-check"></i> إنهاء التعديل';
                this.classList.add('btn-success');
                showNotification('تم تفعيل وضع التعديل المباشر');
            } else {
                editables.forEach(el => {
                    el.contentEditable = 'false';
                    el.style.borderColor = 'transparent';
                    el.style.backgroundColor = 'transparent';
                });
                this.innerHTML = '<i class="fas fa-edit"></i> وضع التعديل';
                this.classList.remove('btn-success');
                showNotification('تم إنهاء وضع التعديل المباشر');
            }
        });

        // إضافة قسم جديد
        const addSectionModal = document.getElementById('add-section-modal');
        const addSectionBtn = document.getElementById('add-section-btn');
        const closeModalBtns = document.querySelectorAll('.close-modal');
        const confirmAddSectionBtn = document.getElementById('confirm-add-section');

        addSectionBtn.addEventListener('click', function() {
            addSectionModal.style.display = 'flex';
        });

        closeModalBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                this.closest('.modal').style.display = 'none';
            });
        });

        confirmAddSectionBtn.addEventListener('click', function() {
            const title = document.getElementById('new-section-title').value;
            const content = document.getElementById('new-section-content').value;
            
            if (title) {
                const sectionHTML = `
                    <div class="cv-section">
                        <h3 class="section-title">
                            <span>${title}</span>
                            <div class="section-controls">
                                <button class="edit-section-btn" title="تعديل"><i class="fas fa-edit"></i></button>
                                <button class="remove-section-btn" title="حذف"><i class="fas fa-trash"></i></button>
                            </div>
                        </h3>
                        <div class="editable" contenteditable="false">${content}</div>
                    </div>
                `;
                
                document.querySelector('.cv-content').insertAdjacentHTML('beforeend', sectionHTML);
                addSectionModal.style.display = 'none';
                document.getElementById('new-section-title').value = '';
                document.getElementById('new-section-content').value = '';
                
                // إضافة أحداث للأقسام الجديدة
                attachSectionEvents();
                showNotification('تم إضافة القسم الجديد بنجاح');
            } else {
                showNotification('يرجى إدخال عنوان للقسم الجديد', 'warning');
            }
        });

        // إرفاق أحداث للأقسام
        function attachSectionEvents() {
            // أحداث حذف الأقسام
            document.querySelectorAll('.remove-section-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (confirm('هل أنت متأكد من حذف هذا القسم؟')) {
                        this.closest('.cv-section').remove();
                        showNotification('تم حذف القسم بنجاح');
                    }
                });
            });
            
            // أحداث تعديل الأقسام
            document.querySelectorAll('.edit-section-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const section = this.closest('.cv-section');
                    const title = section.querySelector('.section-title span').textContent;
                    const content = section.querySelector('.editable').innerHTML;
                    
                    document.getElementById('new-section-title').value = title;
                    document.getElementById('new-section-content').value = content;
                    addSectionModal.style.display = 'flex';
                    
                    // إزالة القسم القديم بعد التأكيد
                    const confirmHandler = function() {
                        const newTitle = document.getElementById('new-section-title').value;
                        const newContent = document.getElementById('new-section-content').value;
                        
                        if (newTitle) {
                            section.querySelector('.section-title span').textContent = newTitle;
                            section.querySelector('.editable').innerHTML = newContent;
                            addSectionModal.style.display = 'none';
                            document.getElementById('new-section-title').value = '';
                            document.getElementById('new-section-content').value = '';
                            
                            // إعادة تعيين الحدث
                            confirmAddSectionBtn.onclick = originalAddSectionHandler;
                            showNotification('تم تعديل القسم بنجاح');
                        }
                    };
                    
                    confirmAddSectionBtn.onclick = confirmHandler;
                });
            });
        }

        // حفظ المعالج الأصلي لإضافة الأقسام
        const originalAddSectionHandler = confirmAddSectionBtn.onclick;

        // محرر النصوص
        const textEditorModal = document.getElementById('text-editor-modal');
        const textEditor = document.getElementById('text-editor');
        const saveTextBtn = document.getElementById('save-text');
        const boldBtn = document.getElementById('bold-btn');
        const italicBtn = document.getElementById('italic-btn');
        const underlineBtn = document.getElementById('underline-btn');

        function openTextEditor(content) {
            textEditor.value = content;
            textEditorModal.style.display = 'flex';
        }

        saveTextBtn.addEventListener('click', function() {
            if (currentEditingElement) {
                currentEditingElement.innerHTML = textEditor.value;
                currentEditingElement = null;
                textEditorModal.style.display = 'none';
                showNotification('تم حفظ التعديلات بنجاح');
            }
        });

        // أدوات تنسيق النص
        boldBtn.addEventListener('click', function() {
            document.execCommand('bold', false, null);
        });

        italicBtn.addEventListener('click', function() {
            document.execCommand('italic', false, null);
        });

        underlineBtn.addEventListener('click', function() {
            document.execCommand('underline', false, null);
        });

        // مشاركة السيرة الذاتية
        const shareModal = document.getElementById('share-modal');
        const shareCvBtn = document.getElementById('share-cv');
        const previewShareBtn = document.getElementById('preview-share-btn');

        shareCvBtn.addEventListener('click', function() {
            shareModal.style.display = 'flex';
        });

        previewShareBtn.addEventListener('click', function() {
            shareModal.style.display = 'flex';
        });

        // معالجة خيارات المشاركة
        document.querySelectorAll('.share-option').forEach(option => {
            option.addEventListener('click', function() {
                const platform = this.getAttribute('data-platform');
                const cvTitle = document.getElementById('preview-name').textContent || 'سيرتي الذاتية';
                const cvUrl = window.location.href;
                
                switch(platform) {
                    case 'facebook':
                        window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(cvUrl)}`, '_blank');
                        break;
                    case 'twitter':
                        window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(cvTitle)}&url=${encodeURIComponent(cvUrl)}`, '_blank');
                        break;
                    case 'linkedin':
                        window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(cvUrl)}`, '_blank');
                        break;
                    case 'whatsapp':
                        window.open(`https://wa.me/?text=${encodeURIComponent(cvTitle + ' ' + cvUrl)}`, '_blank');
                        break;
                    case 'link':
                        navigator.clipboard.writeText(cvUrl).then(() => {
                            showNotification('تم نسخ الرابط إلى الحافظة');
                        });
                        break;
                }
                
                shareModal.style.display = 'none';
            });
        });

        // إضافة بعض البيانات الافتراضية للعرض
        window.onload = function() {
            // إضافة بعض الأمثلة
            document.getElementById('full-name').value = 'أحمد محمد';
            document.getElementById('full-name').dispatchEvent(new Event('input'));
            
            document.getElementById('job-title').value = 'مطور ويب';
            document.getElementById('job-title').dispatchEvent(new Event('input'));
            
            document.getElementById('personal-summary').value = 'مطور ويب بخبرة 5 سنوات في تصميم وتطوير المواقع الإلكترونية والتطبيقات التفاعلية.';
            document.getElementById('personal-summary').dispatchEvent(new Event('input'));
            
            document.getElementById('contact-email').value = 'ahmed@example.com';
            document.getElementById('contact-email').dispatchEvent(new Event('input'));
            
            document.getElementById('contact-phone').value = '+966500000000';
            document.getElementById('contact-phone').dispatchEvent(new Event('input'));
            
            document.getElementById('contact-address').value = 'الرياض، المملكة العربية السعودية';
            document.getElementById('contact-address').dispatchEvent(new Event('input'));
            
            // إضافة أمثلة للخبرات والمهارات
            document.getElementById('experience-title').value = 'مطور ويب';
            document.getElementById('experience-company').value = 'شركة التقنية';
            document.getElementById('experience-duration').value = '2020 - 2023';
            document.getElementById('experience-description').value = 'تطوير وتصميم مواقع إلكترونية باستخدام HTML, CSS, JavaScript';
            document.getElementById('add-experience').click();
            
            document.getElementById('skill-name').value = 'HTML/CSS';
            document.getElementById('skill-level').value = '9';
            document.getElementById('add-skill').click();
            
            document.getElementById('education-degree').value = 'بكالوريوس علوم الحاسب';
            document.getElementById('education-institution').value = 'جامعة الملك سعود';
            document.getElementById('education-year').value = '2019';
            document.getElementById('add-education').click();
            
            // تطبيق الخطوط المختارة
            applyFonts();
            
            // إرفاق أحداث للأقسام
            attachSectionEvents();
            attachItemEvents();
            
            showNotification('مرحباً بك في مصمم السيرة الذاتية المتقدم!');
        };
    </script>
</body>
</html>
